{% load static %}
<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
	<!-- Mobile Specific Meta -->
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Favicon-->
	<link rel="shortcut icon" href="img/fav.png">
	<!-- Author Meta -->
	<meta name="author" content="CodePixar">
	<!-- Meta Description -->
	<meta name="description" content="">
	<!-- Meta Keyword -->
	<meta name="keywords" content="">
	<!-- meta character set -->
	<meta charset="UTF-8">
	<!-- Site Title -->
	<title>Trends</title>
	<!--
		CSS
		============================================= -->

    <!--alertify CSS -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css"/>
    <!-- Default theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css"/>
    
	<link rel="stylesheet" href="{% static 'css/linearicons.css' %}">
	<link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/themify-icons.css' %}">
	<link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
	<link rel="stylesheet" href="{% static 'css/owl.carousel.css' %}">
	<link rel="stylesheet" href="{% static 'css/nice-select.css' %}">
	<link rel="stylesheet" href="{% static 'css/nouislider.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/ion.rangeSlider.css' %}" >
	<link rel="stylesheet" href="{% static 'css/ion.rangeSlider.skinFlat.css' %}" >
	<link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">
	<link rel="stylesheet" href="{% static 'css/main.css' %}">
	<link rel="stylesheet" href="{% static 'css/userprofile.css' %}">
</head>

<body>

	<!-- Start Header Area -->
	<header class="header_area sticky-header">
		<div class="main_menu">
			<nav class="navbar navbar-expand-lg navbar-light main_box">
				<div class="container">
					<!-- Brand and toggle get grouped for better mobile display -->
					<span class="navbar-brand logo_h"><img src="https://img.icons8.com/external-justicon-flat-justicon/64/000000/external-shoes-fitness-gym-justicon-flat-justicon.png"/></span>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
					 aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse offset" id="navbarSupportedContent">
						<ul class="nav navbar-nav menu_nav ml-auto">
							<li class="nav-item "><a class="nav-link" href="{% url 'index' %}">Home</a></li>
							<li class="nav-item submenu dropdown">
								<a href="{% url 'category' 0 %}" class="nav-link "  role="button" >Shop</a>
							</li>
							<li class="nav-item submenu dropdown">
								{% if user.is_authenticated %}
								<a href="{% url 'logout' %}" class="nav-link" >Logout</a>
								{% else %}
								<a href="{% url 'login' %}" class="nav-link" >Login</a>
								{% endif %}
							</li>
							<li class="nav-item"><a class="nav-link" href="{% url 'contact' %}">Contact</a></li>
						</ul>
						<ul class="nav navbar-nav navbar-right">
							<li class="nav-item"><a href="{% url 'viewcart' %}" class="cart"><span class="ti-bag"></span></a></li>
                            <li class="nav-item"><a href="{% url 'wishlist' %}" class="wishlist"><span class="lnr lnr-heart"></span></a></li>
							{% if user.is_authenticated %}
							<li class="nav-item"><a href="{% url 'userprofile' user.id %}" class="w-3"><span><img src="https://img.icons8.com/fluency-systems-regular/48/null/user.png" style="width:22px" /></span></a></li>
							{% endif %}
						</ul>
					</div>
				</div>
			</nav>
		</div>
	</header>
    <!-- Start Banner Area -->
	<section class="banner-area organic-breadcrumb">
		<div class="container">
			<div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
				<div class="col-first">
					<h1>My Orders</h1>
				</div>
			</div>
		</div>
	</section>
    <div class="container mt-4">
        <div class="row">
            <div class="col-lg-3 my-lg-0 my-md-1">
                <div id="sidebar" class="bg-purple">
                    <div class="h4 text-white">Account</div>
                    <ul>
                        <li >
                            <a href="{% url 'userprofile' user.id %}" class="text-decoration-none d-flex align-items-start">
                                <div class="fas fa-box pt-2 me-3"></div>
                                <div class="d-flex flex-column">
                                    <div class="link">My Profile</div>
                                    <div class="link-desc">View & Manage orders and returns</div>
                                </div>
                            </a>
                        </li>
                        <li class="active">
                            <a href="#" class="text-decoration-none d-flex align-items-start">
                                <div class="fas fa-box-open pt-2 me-3"></div>
                                <div class="d-flex flex-column">
                                    <div class="link">My Orders</div>
                                    <div class="link-desc">Change your profile details & password</div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-9 my-lg-0 my-1">
                <div id="main-content" class="bg-white border">
                    <div class="d-flex flex-column">
                        <div class="h5">Hello {{user.username}},</div>
                        <div>Logged in as: {{user.email}}</div>
                    </div>
                    <div class="text-uppercase mt-3 ">My orders</div>
                    {% for order in orders %}
                    <div class="order my-3 bg-light">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="d-flex flex-column justify-content-between order-summary">
                                    <div class="d-flex align-items-center">
                                        <div class="text-uppercase">Order id:{{ order.order_number }}</div>
                                        {% comment %} <div class="blue-label ms-auto text-uppercase ml-3">  {{order.payment.payment_method}} </div> {% endcomment %}
                                    </div>
                                    {% comment %} <div class="fs-8">Products #03</div> {% endcomment %}
                                    <div class="fs-8">Placed on: {{order.created_at}}</div>
                                    <div>Payment Method: {{order.payment.payment_method}}</div>
                                    <div ><h5>Price : Rs.{{ order.order_total }}</h5>
                                    </div>
                                </div>
                            </div>
                            <form action="{% url 'cancelOrder' %}" method='POST' style="width: 10rem">
                            {% csrf_token %}
                            <div class="col-lg-6 ">
                                <div class=" align-items-sm-start justify-content-sm-between">
                                <div><a href="{% url 'vieworder' order.id %}" class="btn btn-primary text-uppercase mt-2" >order info</a></div>
                                {% if order.status == 'Cancelled' %}
                                    <div class="btn" style="font-size: 15px" >
                                    Status: <span style="color: red ">{{ order.status }}</span>
                                    </div>
                                {% elif order.status == 'Delivered' %}
                                    <div class="btn" style="font-size: 15px" >
                                    Status: <span style="color: green ">{{ order.status }}</span>
                                    </div>
                                {% else %}
                                    <div class="btn " style="font-size: 15px" >
                                    Status: {{ order.status }}
                                    </div>
                                {% endif %}
                                    {% comment %} <div class="btn status mt-3">Status : {% if order.status is 'Cancelled' %} <span style="color: 'red' " > {{ order.status  }} </span> {% else %} {{ order.status  }} {% endif %} </div> {% endcomment %}
                                    <input type="hidden" name="id" value="{{ order.id }}">
                                    {% if order.status == 'Cancelled' and order.payment.payment_method == 'Paid by Razorpay' %}
                                    <div> <button  class="btn " >Refunded</button></div>
                                    {% elif order.status == 'Cancelled' and order.payment.payment_method == 'COD' %}
                                    <div> <button  class="btn" ></button></div>
                                    {% elif order.status == 'Delivered' %}
                                    <div> <button  class="btn" ></button></div>
                                    {% else %}
                                    <div> <button  class="btn" type="submit" style="font-size: small;  border: 1px solid red;" onclick="return confirm('Are You Sure ?')">Cancel</button></div>
                                    {% endif %}
                                </div>
                                </div>
                                </form>
                            </div>
                        </div>
                    {% endfor %}
                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
	<!-- End Banner Area -->

    <script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>

	<script>
        alertify.set('notifier','position', 'top-right');
        {% for msg in messages %}
			{% if msg.tags == 'success' %}
            alertify.success('{{ msg }}');
			{% else %}
			alertify.warning('{{ msg }}');
			{% endif %}
        {% endfor %}
        
    </script>

    <script src="{% static 'js/vendor/jquery-2.2.4.min.js' %}"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
	 crossorigin="anonymous"></script>
	<script src="{% static 'js/vendor/bootstrap.min.js' %}"></script>
	<script src="{% static 'js/jquery.ajaxchimp.min.js' %}"></script>
	<script src="{% static 'js/jquery.nice-select.min.js' %}"></script>
	<script src="{% static 'js/jquery.sticky.js' %}"></script>
	<script src="{% static 'js/nouislider.min.js' %}"></script>
	<script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
	<script src="{% static 'js/owl.carousel.min.js' %}"></script>
	<!--gmaps Js-->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE"></script>
	<script src="{% static 'js/gmaps.min.js' %}"></script>
	<script src="{% static 'js/main.js' %}"></script>
</body>

</html>